\documentclass{siamart190516}

\input{ex_shared}

% Optional PDF information
\ifpdf
\hypersetup{
  pdftitle={6.437 Final Project Part I},
  pdfauthor={Juan M Ortiz}
}
\fi

\begin{document}
\maketitle

\section*{Problem I: A Bayesian Framework}
\label{sec:bayesian}


\begin{enumerate}[(a)]

  % Part A
  \item \begin{align*}
          p_{\textbf{y}|f}(\textbf{y}|f) & = \prob{ \textbf{x}_0 = \inv{f}(\textbf{y}_0)} \prod_{j = 1}^{n-1} \prob{\textbf{x}_j = \inv{f}(y_j) | \textbf{x}_{j-1} = \inv{f}} \\
                                         & = p_{\inv{f}(y)}(\inv{f}(\textbf{y}_0)) \prod_{j = 1}^{n-1} M_{\inv{f}(\textbf{y})_{j}, \inv{f}(\textbf{y})_{j-1}}
        \end{align*}

        % Part B
  \item \begin{align*}
          p_{f|\textbf{y}}(f | \textbf{y}) & = \frac{ p_{\textbf{y}|f}(\textbf{y}|f) p_{f}(f) }{p_\textbf{y}(y)}                                                                                                                                                                                  \\
                                           & = \frac{p_{\inv{f}(y)}(\inv{f}(\textbf{y}_0)) \prod_{j = 1}^n M_{\inv{f}(\textbf{y})_{j}, \inv{f}(\textbf{y})_{j-1}}}{\sum_{g \in \F}(p_{\inv{g}(y)}(\inv{g}(\textbf{y}_0)) \prod_{j = 1}^n M_{\inv{g}(\textbf{y})_{j}, \inv{g}(\textbf{y})_{j-1}})}
        \end{align*}
        Where $\F$ is the set of all permutations of $\mathcal{A}$. Thus, the MAP estimator is one that maximizes the above expression or, equivalently, its numerator. Thus
        \[
          \hat{f}_{MAP} = \argmax_{f \in \F} p_{\inv{f}(y)}(\inv{f}(\textbf{y}_0)) \prod_{j = 1}^n M_{\inv{f}(\textbf{y})_{j}, \inv{f}(\textbf{y})_{j-1}}
        \]
        % Part C
  \item Direct computation of the $\hat{f}_{MAP}$ is infeasable because it requires an optimization over a large, discrete, non-linear set. Computing expression on (b) would optimize over $\F$ which has a size of $\norm{\F} = \norm{\mathcal{A}}! = 28! \simeq 10^{29}$. Additionally, the constraints necessary to enforce that the $f \in \F$ is permutation will be hard to optimize over.
\end{enumerate}

\section*{Problem 2: Markov Chain Monte Carlo method}
\label{sec:mcmc}
\begin{enumerate}[(a)]
  % Part A
  \item After the first fixing one of the two cyphering functions $f_1 \in \F$, there are $\binom{\norm{\mathcal{A}}}{2}$ possible $f_2 \in \F$ such that g differs in exactly two symbol assignments (i.e. those that swap two distinct element assignments in $f_1$). Thus, the probability that $f_1$ and $f_2$ differ in exactly two symbol assignments is given by:

        \[
          \frac{\binom{\mathcal{A}}{2}}{\norm{A}!} = \frac{1}{2(\norm{A} - 2)!}
        \]

        % Part B
  \item First, notice that the distribution $p_{f | \textbf{y}}$ can be factorized in to hold the form $p_{f | \textbf{y}}(f | \textbf{y}) = \frac{1}{Z}\tilde{p}_{f | \textbf{y}}$ where
        \begin{align*}
          \tilde{p}_{f | \textbf{y}} & = p_{\inv{f}(y)}(\inv{f}(\textbf{y}_0)) \prod_{j = 1}^n M_{\inv{f}(\textbf{y})_{j}, \inv{f}(\textbf{y})_{j-1}}                  \\
          Z                          & = \sum_{g \in \F}(p_{\inv{g}(y)}(\inv{g}(\textbf{y}_0)) \prod_{j = 1}^n M_{\inv{g}(\textbf{y})_{j}, \inv{g}(\textbf{y})_{j-1}})
        \end{align*}

        If we let the proposal distribution $V(f' | f)$ be defined as
        \[
          V(f' | f) = \begin{cases}
            \binom{\norm{\A}}{2}^{-1} \text{  for f and f' differ in exactly two symbol assignments} \\
            0 \text{  otherwise}
          \end{cases}
        \]

        When executing Metropolis-Hastings we compute the acceptance factor as follows:

        \begin{align*}
          a(f \rightarrow f') & \triangleq \min(1, \frac{\tilde{p}_{f | \textbf{y}}(f' | \textbf{y})}{\tilde{p}_{f | \textbf{y}}(f | \textbf{y})} \frac{V(f | f')}{V(f' | f)}) \\
                              & =\min(1, \frac{\tilde{p}_{f | \textbf{y}}(f' | \textbf{y})}{\tilde{p}_{f | \textbf{y}}(f | \textbf{y})})
        \end{align*}

        Note that in the event that $\tilde{p}_{f | \textbf{y}}(f' | \textbf{y}) = \tilde{p}_{f | \textbf{y}}(f' | \textbf{y}) = 0$, we will define $a(f \rightarrow f') = 1$.

        % Part C
  \item
        \begin{algorithm*}
          \caption{Decoding using Metropolis-Hastings}
          \label{alg:decoding}
          \begin{algorithmic}
            \STATE $\hat{\F} \leftarrow \{\}$
            \STATE $f \leftarrow$ random permutation of $\A$

            \WHILE{$\norm{\hat{\F}} < 5000$}
            \STATE $f' \leftarrow$ permutation obtained by swapping two assignments of $f$ at random.
            \STATE $a(f \rightarrow f') \leftarrow \min(1, \frac{\tilde{p}_{f | \textbf{y}}(f' | \textbf{y})}{\tilde{p}_{f | \textbf{y}}(f | \textbf{y})})$
            \STATE $r \sim \unif(0, 1)$
            \IF{$r \leq a(f \rightarrow f')$}
            \STATE $\hat{\F} = \hat{\F} \cup \{ f' \}$
            \STATE $f \leftarrow f'$
            \ENDIF
            \ENDWHILE

            \STATE $f_{MAP} = \argmax_{f \in \hat{\F}} \tilde{{p}}_{f | \textbf{y}}(f | \textbf{y})$
            \RETURN $\inv{f_{MAP}}(\textbf{y})$
          \end{algorithmic}
        \end{algorithm*}
\end{enumerate}

\section{Experimental results}
\label{sec:experiments}

\begin{enumerate}[(a)]
  \item part a
  \item part b
  \item part c
  \item part d
  \item part e
\end{enumerate}

\end{document}
